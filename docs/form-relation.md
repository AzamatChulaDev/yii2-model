# Компонент данных реляции формы

Компонент разработан для упрощенного предоставления данных о реляции
для выпадающих списков формы. Интерфейс достаточно гибкий и можно
расширить функциональность для расширения возможности управления реляциями.

## Использование

### 1. Интерфейс формы

Форма должна реализовывать функциональность интерфейса: `RelationOwnerInterface`,
который требует реализации одного метода: `initRelationData()`.

Вторым этапом является наполнение метода данными о реляции для генерации данных:

```php
public function initRelationData()
{
    return [
        'interviewee' => new RelationData(
            Person::class, 'interviewee', $this->model, 'fullname'
        ),
        'nextPost' => new RelationData(
            Post::class, 'nextPost', $this->model
        ),
    ];
}
```

`RelationData` является классом реализующим интерфейс для генерации данных
выпадающих списков основанном на данных реляции из модели, с возможностью
получения недостающих (новых) данных через интерфейс `ActiveRecord`.

### 2. Поведение формы

На втором этапе в форму необходимо внедрить поведение, которое минимизирует
повторяемость кода для предоставления данныхь о реляции в представлении:

```php
/**
 * @mixin RelationDataBehavior
 */
class PostForm extends Form implements RelationOwnerInterface
{
    public function behaviors()
    {
        return [
            RelationDataBehavior::class,
        ];
    }
}
```

Данный шаг предоставляет простой доступ к данным из интерфейса `RelationOwnerInterface`
с предворительной обработкой и кешированием результата предыдущего запроса.

### 3. Getters

К сожалению механизм не совершенен и для его оптимизации потребуется сверх
раздутая конфигурация поведения или на уровне самой формы. Поэтому для предоставления
внешнего доступа необходимо формирование простых getter методов в форме.
Кроме внешнего доступа, этим шагом мы уменьшаем объем конфигурации и увеличиваем
динамичность изменчивых данных реляций.

```php
public function getIntervieweeData()
{
    if ($this->interviewee_id) {
        return $this->getRelationData('interviewee', $this->interviewee_id);
    }
    return [];
}
```
